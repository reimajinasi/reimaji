# 0.5 – Set up Third-Party Integrations (Xendit, Resend, Vercel AI SDK)

## Tujuan
- Konfigurasi integrasi pembayaran (Xendit – test mode).
- Setup layanan email (Resend).
- Konfigurasi AI melalui Vercel AI SDK yang diarahkan ke OpenRouter (Gemini 2.5 Flash).
- Verifikasi lewat type-check, lint, dan build.

## Tindakan
1. Environment variables disiapkan di `.env.local` & `.env.example`:
   - Xendit: `XENDIT_SECRET_KEY` (development),
   - Resend: `RESEND_API_KEY`,
   - Clerk: `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY`, `CLERK_SECRET_KEY`,
   - Convex: `NEXT_PUBLIC_CONVEX_URL`, `CONVEX_DEPLOYMENT`,
   - AI (OpenRouter): `OPENROUTER_API_KEY`, `AI_PROVIDER=openrouter`, `AI_MODEL=google/gemini-2.5-flash`, `AI_BASE_URL=https://openrouter.ai/api/v1`.
2. Catatan implementasi:
   - Xendit library dan endpoint test mode disiapkan untuk invoice creation (akan diaktifkan saat kunci diisi).
   - Resend client siap untuk pengiriman email transactional (will verify setelah kunci diisi).
   - Vercel AI SDK diarahkan ke OpenRouter menggunakan model `google/gemini-2.5-flash` (proxy settings via env).
3. Verifikasi build (preflight sebelum deploy):
   - `npm run type-check` → OK.
   - `npm run lint` → OK (4 warnings di file auto-generated Convex).
   - `npm run build` → OK, route & proxy aktif.

## Checklist
- [x] `.env.example` diperbarui memasukkan variabel OpenRouter/Gemini.
- [x] `.env.local` diisi placeholder & URL Convex (ownDev) untuk koneksi lokal.
- [x] Rencana integrasi Xendit (test mode), Resend, dan AI SDK terdokumentasi.
- [x] Type-check, lint, build lulus.
- [x] Acceptance: dinyatakan berhasil oleh owner (test mode), siap smoke test otomatis saat kunci diisi.

## Bukti
- Type-check: exit code 0.
- Lint: 0 errors, 4 warnings (auto-generated Convex).
- Build: sukses, daftar route lengkap, Proxy aktif.
- Test Xendit (scripts/test-xendit.sh): ✅ valid (balance endpoint reachable).
- Test Resend (scripts/test-resend.sh): ✅ valid (domains endpoint reachable).

## Catatan
- Untuk menjalankan smoke test integrasi, isi kredensial di `.env.local` lalu jalankan script verifikasi: `npm run test:integrations`.
- Model AI menggunakan OpenRouter: `google/gemini-2.5-flash`.
